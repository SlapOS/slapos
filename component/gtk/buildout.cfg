[buildout]
extends =
  ../bzip2/buildout.cfg
  ../dbus/buildout.cfg
  ../fontconfig/buildout.cfg
  ../freetype/buildout.cfg
  ../gettext/buildout.cfg
  ../glib/buildout.cfg
  ../glycin/buildout.cfg
  ../intltool/buildout.cfg
  ../jbigkit/buildout.cfg
  ../libepoxy/buildout.cfg
  ../libjpeg/buildout.cfg
  ../libpng/buildout.cfg
  ../libpsl/buildout.cfg
  ../libsigc/buildout.cfg
  ../libtiff/buildout.cfg
  ../meson/buildout.cfg
  ../nodejs/buildout.cfg
  ../ninja/buildout.cfg
  ../patchelf/buildout.cfg
  ../perl/buildout.cfg
  ../perl-XML-Parser/buildout.cfg
  ../python3/buildout.cfg
  ../pkgconfig/buildout.cfg
  ../xorg/buildout.cfg
  ../icu/buildout.cfg
  ../xorg/buildout.cfg
  ../xz-utils/buildout.cfg
  ../zlib/buildout.cfg



[cairo]
recipe = slapos.recipe.cmmi
shared = true
url = https://cairographics.org/releases/cairo-1.18.4.tar.xz
md5sum = db575fb41bbda127e0147e401f36f8ac
pkg_config_depends = ${fontconfig:location}/lib/pkgconfig:${fontconfig:pkg_config_depends}:${glib:location}/lib/pkgconfig:${glib:pkg_config_depends}:${libXext:location}/lib/pkgconfig:${libXext:pkg_config_depends}:${libpng:location}/lib/pkgconfig:${pixman:location}/lib/pkgconfig:${libXrender:location}/lib/pkgconfig:${libXrender:pkg_config_depends}:${libsigc:location}/lib/pkgconfig
configure-command =
  meson setup builddir --wrap-mode=nodownload --libdir=lib -Dprefix=${:location} -Dgtk_doc=false -Dtee=enabled -Dxlib=enabled -Dxcb=disabled -Dfreetype=enabled -Dfontconfig=enabled
make-binary = ninja -C builddir
environment =
  PATH=${meson:location}/bin:${ninja:location}/bin:${freetype:location}/bin:${pkgconfig:location}/bin:${xz-utils:location}/bin:%(PATH)s
  PKG_CONFIG_PATH=${:pkg_config_depends}
  CPPFLAGS=-I${zlib:location}/include
  LDFLAGS=-Wl,-rpath=${bzip2:location}/lib -Wl,-rpath=${gettext:location}/lib -L${zlib:location}/lib -Wl,-rpath=${zlib:location}/lib -Wl,-rpath=${glib:location}/lib -Wl,-rpath=${fontconfig:location}/lib -Wl,-rpath=${libXrender:location}/lib -Wl,-rpath=${pixman:location}/lib -Wl,-rpath=${libX11:location}/lib -Wl,-rpath=${libpng:location}/lib -Wl,-rpath=${libXext:location}/lib -Wl,-rpath=${freetype:location}/lib -Wl,-rpath=${libexpat:location}/lib -Wl,-rpath=${:location}/lib
location = @@LOCATION@@


[harfbuzz]
recipe = slapos.recipe.cmmi
shared = true
url = https://github.com/harfbuzz/harfbuzz/releases/download/12.2.0/harfbuzz-12.2.0.tar.xz
md5sum = d9c0c102a1595e718fd5bbb0e4497594
pkg_config_depends = ${cairo:location}/lib/pkgconfig:${cairo:pkg_config_depends}:${icu4c:location}/lib/pkgconfig:${freetype:location}/lib/pkgconfig
configure-command =
  meson setup builddir --wrap-mode=nodownload --libdir=lib -Dprefix="@@LOCATION@@" -Dintrospection=disabled -Dfreetype=enabled
make-binary = ninja -C builddir
environment =
  PATH=${glib:location}/bin:${python3:location}/bin:${freetype:location}/bin:${meson:location}/bin:${ninja:location}/bin:${pkgconfig:location}/bin:${xz-utils:location}/bin:%(PATH)s
  PKG_CONFIG_PATH=${:pkg_config_depends}
  LDFLAGS=-Wl,-rpath=${gettext:location}/lib -Wl,-rpath=${bzip2:location}/lib -Wl,-rpath=${zlib:location}/lib -Wl,-rpath=${icu4c:location}/lib -Wl,-rpath=${glib:location}/lib -Wl,-rpath=${cairo:location}/lib -Wl,-rpath=${freetype:location}/lib -Wl,-rpath=${libpng:location}/lib -Wl,-rpath=${libX11:location}/lib -Wl,-rpath=${libXext:location}/lib  -Wl,-rpath=${pixman:location}/lib -Wl,-rpath=${libxcb:location}/lib -Wl,-rpath=${libXdmcp:location}/lib -Wl,-rpath=${freetype:location}/lib -Wl,-rpath=@@LOCATION@@/lib
  CFLAGS=-I${icu4c:location}/include

[fribidi]
recipe = slapos.recipe.cmmi
shared = true
url = https://github.com/fribidi/fribidi/releases/download/v1.0.16/fribidi-1.0.16.tar.xz
md5sum = 333ad150991097a627755b752b87f9ff
configure-options =
  --enable-shared
  --disable-static
environment =
  PATH=${xz-utils:location}/bin:%(PATH)s

[pango]
recipe = slapos.recipe.cmmi
shared = true
url = https://download.gnome.org/sources/pango/1.57/pango-1.57.0.tar.xz
md5sum = c027445c1325603a2a11df2fd868e6b8
location = @@LOCATION@@
pkg_config_depends = ${fribidi:location}/lib/pkgconfig:${harfbuzz:location}/lib/pkgconfig:${harfbuzz:pkg_config_depends}:${fontconfig:pkg_config_depends}:${fontconfig:location}/lib/pkgconfig
configure-command =
  meson setup builddir --wrap-mode=nodownload --libdir=lib -Dprefix=${:location} -Ddocumentation=false -Dintrospection=disabled -Dbuild-testsuite=false -Dbuild-examples=false -Dfontconfig=enabled -Dfreetype=enabled -Dxft=disabled
make-binary = ninja -C builddir
post-install =
# adjust rpath that is not set correctly, although we set LDFLAGS
  NEW_RPATH=${freetype:location}/lib:${cairo:location}/lib:$(patchelf --print-rpath ${:location}/lib/libpangoft2-1.0.so.0)
  patchelf --set-rpath $NEW_RPATH ${:location}/lib/libpangoft2-1.0.so.0
  NEW_RPATH=${freetype:location}/lib:${cairo:location}/lib:$(patchelf --print-rpath ${:location}/lib/libpangocairo-1.0.so.0)
  patchelf --set-rpath $NEW_RPATH ${:location}/lib/libpangocairo-1.0.so.0
  NEW_RPATH=${freetype:location}/lib:${cairo:location}/lib:$(patchelf --print-rpath ${:location}/bin/pango-view)
  patchelf --set-rpath $NEW_RPATH ${:location}/bin/pango-view

environment =
  PATH=${patchelf:location}/bin:${gperf:location}/bin:${glib:location}/bin:${python3:location}/bin:${freetype:location}/bin:${meson:location}/bin:${ninja:location}/bin:${pkgconfig:location}/bin:${xz-utils:location}/bin:%(PATH)s
  PKG_CONFIG_PATH=${:pkg_config_depends}
  LDFLAGS=-Wl,-rpath=${gettext:location}/lib -Wl,-rpath=${bzip2:location}/lib -Wl,-rpath=${zlib:location}/lib -Wl,-rpath=${harfbuzz:location}/lib -Wl,-rpath=${glib:location}/lib -Wl,-rpath=${fribidi:location}/lib -Wl,-rpath=${fontconfig:location}/lib -Wl,-rpath=@@LOCATION@@/lib


[gdk-pixbuf]
recipe = slapos.recipe.cmmi
shared = true
url = https://download.gnome.org/sources/gdk-pixbuf/2.44/gdk-pixbuf-2.44.4.tar.xz
md5sum = 2676fd771eeec4ecee3af4b366aa1412
configure-command = ${meson:location}/bin/meson setup builddir --wrap-mode=nodownload --libdir=lib -Dprefix=@@LOCATION@@ -Dgtk_doc=false -Dman=false -Dgio_sniffing=false -Dglycin=disabled
make-binary = ninja -C builddir
#pkg_config_depends = ${glib:location}/lib/pkgconfig:${glib:pkg_config_depends}:${glycin:location}/lib/pkgconfig:${libX11:location}/lib/pkgconfig:${libX11:pkg_config_depends}:${libpng:location}/lib/pkgconfig:${libjpeg:location}/lib/pkgconfig:${libtiff:location}/lib/pkgconfig
pkg_config_depends = ${glib:location}/lib/pkgconfig:${glib:pkg_config_depends}:${libX11:location}/lib/pkgconfig:${libX11:pkg_config_depends}:${libpng:location}/lib/pkgconfig:${libjpeg:location}/lib/pkgconfig:${libtiff:location}/lib/pkgconfig
environment =
  PATH=${glib:location}/bin:${perl:location}/bin:${python3:location}/bin:${ninja:location}/bin:${pkgconfig:location}/bin:${xz-utils:location}/bin:${libpng:location}/bin:%(PATH)s
  PKG_CONFIG_PATH=${:pkg_config_depends}
  CFLAGS=-I${gettext:location}/include
  LDFLAGS=-L${gettext:location}/lib -Wl,-rpath=${gettext:location}/lib -Wl,-rpath=${glib:location}/lib -Wl,-rpath=${jbigkit:location}/lib -Wl,-rpath=${libtiff:location}/lib -Wl,-rpath=${libjpeg:location}/lib -Wl,-rpath=${libpng:location}/lib -Wl,-rpath=${zlib:location}/lib -Wl,-rpath=@@LOCATION@@/lib

[atk]
recipe = slapos.recipe.cmmi
shared = true
url = https://download.gnome.org/sources/atk/2.38/atk-2.38.0.tar.xz
md5sum = 4dcea15cbf166706c166fc4fee05e3f8
configure-command = ${meson:location}/bin/meson setup builddir --wrap-mode=nodownload --libdir=lib -Dprefix=@@LOCATION@@ -Ddocs=false -Dintrospection=false
make-binary = ninja -C builddir
environment =
  PATH=${glib:location}/bin:${python3:location}/bin:${ninja:location}/bin:${pkgconfig:location}/bin:${xz-utils:location}/bin:%(PATH)s
  PKG_CONFIG_PATH=${glib:location}/lib/pkgconfig:${glib:pkg_config_depends}
  CFLAGS=-I${gettext:location}/include
  LDFLAGS=-L${gettext:location}/lib -lintl -Wl,-rpath=${gettext:location}/lib -Wl,-rpath=${glib:location}/lib -Wl,-rpath=${libsigc:location}/lib

[at-spi2-core]
recipe = slapos.recipe.cmmi
shared = true
url = https://download.gnome.org/core/42/42.10/sources/at-spi2-core-2.44.1.tar.xz
md5sum = 7e30e7c82879ef13a76891dccee723cb
configure-command = ${meson:location}/bin/meson setup builddir --wrap-mode=nodownload --libdir=lib -Dprefix=@@LOCATION@@ -Ddocs=false -Dintrospection=no
make-binary = ninja -C builddir
environment =
  PATH=${dbus:location}/bin:${gettext:location}/bin:${glib:location}/bin:${intltool:location}/bin:${perl-XML-Parser:perl-PATH}:${pkgconfig:location}/bin:${xz-utils:location}/bin:${python3:location}/bin:${ninja:location}/bin:%(PATH)s
  PKG_CONFIG_PATH=${dbus:location}/lib/pkgconfig:${glib:location}/lib/pkgconfig:${glib:pkg_config_depends}
  CPPFLAGS=-I${inputproto:location}/include -I${xorgproto:location}/include -I${libX11:location}/include -I${libXi:location}/include -I${libXtst:location}/include -I${xextproto:location}/include -I${xproto:location}/include
  LDFLAGS=-L${libX11:location}/lib -Wl,-rpath=${libX11:location}/lib -L${libXi:location}/lib -Wl,-rpath=${libXi:location}/lib -L${libXtst:location}/lib -Wl,-rpath=${libXtst:location}/lib -L${zlib:location}/lib -Wl,-rpath=${zlib:location}/lib -Wl,-rpath=${glib:location}/lib -Wl,-rpath=${dbus:location}/lib -Wl,-rpath=@@LOCATION@@/lib

[at-spi2-atk]
recipe = slapos.recipe.cmmi
shared = true
url = https://download.gnome.org/core/42/42.10/sources/at-spi2-atk-2.38.0.tar.xz
md5sum = aed95be54ef213d210331dda88298b92
configure-command = ${meson:location}/bin/meson setup builddir --wrap-mode=nodownload --libdir=lib -Dprefix=@@LOCATION@@ -Dtests=false
make-binary = ninja -C builddir
environment =
  PATH=${intltool:location}/bin:${pkgconfig:location}/bin:${xz-utils:location}/bin:${ninja:location}/bin:%(PATH)s
  PKG_CONFIG_PATH=${atk:location}/lib/pkgconfig:${at-spi2-core:location}/lib/pkgconfig:${dbus:location}/lib/pkgconfig:${glib:location}/lib/pkgconfig:${glib:pkg_config_depends}
  LDFLAGS=-Wl,-rpath=${glib:location}/lib -Wl,-rpath=${atk:location}/lib -Wl,-rpath=${at-spi2-core:location}/lib -Wl,-rpath=${dbus:location}/lib -Wl,-rpath=@@LOCATION@@/lib

[gtk-materia-theme]
recipe = slapos.recipe.cmmi
url = https://github.com/nana-4/materia-theme/archive/eb83bc174fad52cba9541efa78587664ca19542c.tar.gz
md5sum = 7072e92f8395770f0ebb43403bd754cc
configure-command =
  meson _build -Dprefix="@@LOCATION@@" -Dcolors=default,light,dark -Dsizes=default,compact
make-targets =
make-binary = meson install -C _build

environment =
  PATH=${ninja:location}/bin:${meson:location}/bin:${glib:location}/bin:${nodejs:location}/bin:%(PATH)s

[libsoup]
recipe = slapos.recipe.cmmi
shared = true
url = https://download.gnome.org/core/44/44.10/sources/libsoup-2.74.3.tar.xz
md5sum = 8f657fd301a213629204b3320c35d75a
pkg_config_depends = ${glib:location}/lib/pkgconfig:${glib:pkg_config_depends}:${libpsl:location}/lib/pkgconfig:${libxml2:location}/lib/pkgconfig:${sqlite3:location}/lib/pkgconfig
configure-command =
  meson setup builddir --wrap-mode=nodownload --libdir=lib -Dprefix="@@LOCATION@@" -Dintrospection=disabled -Dtests=false -Dsysprof=disabled -Dtls_check=false
make-binary = ninja -C builddir
environment =
  PATH=${glib:location}/bin:${meson:location}/bin:${ninja:location}/bin:${pkgconfig:location}/bin:${xz-utils:location}/bin:${python3:location}/bin:%(PATH)s
  PKG_CONFIG_PATH=${:pkg_config_depends}
  LDFLAGS=-Wl,-rpath=${glib:location}/lib -Wl,-rpath=${libpsl:location}/lib -Wl,-rpath=${libxml2:location}/lib -Wl,-rpath=${sqlite3:location}/lib -Wl,-rpath=${zlib:location}/lib -Wl,-rpath=@@LOCATION@@/lib

[graphene]
recipe = slapos.recipe.cmmi
shared = true
url = https://download.gnome.org/sources/graphene/1.10/graphene-1.10.8.tar.xz
md5sum = 169e3c507b5a5c26e9af492412070b81
configure-command =
  meson setup builddir --wrap-mode=nodownload --libdir=lib -Dprefix=${:location} -Dintrospection=disabled
make-binary = ninja -C builddir
environment =
  PATH=${meson:location}/bin:${ninja:location}/bin:${perl:location}/bin:${pkgconfig:location}/bin:${xz-utils:location}/bin:%(PATH)s
  PKG_CONFIG_PATH=${glib:location}/lib/pkgconfig:${glib:pkg_config_depends}
  LDFLAGS=-Wl,-rpath=${glib:location}/lib -Wl,-rpath=${:location}/lib
location = @@LOCATION@@

[sassc]
recipe = slapos.recipe.cmmi
shared = true
url = https://github.com/sass/sassc/archive/refs/tags/3.6.2.tar.gz
md5sum = 4c3b06ce2979f2a9f0a35093e501d8bb
pre-configure = libtoolize && autoreconf --install
environment =
  PATH=${autoconf:location}/bin:${automake:location}/bin:${libtool:location}/bin:${m4:location}/bin:%(PATH)s
  CPPFLAGS=-I${libsass:location}/include
  LDFLAGS=-L${libsass:location}/lib -Wl,-rpath=${libsass:location}/lib


[libsass]
recipe = slapos.recipe.cmmi
shared = true
url = https://github.com/sass/libsass/archive/refs/tags/3.6.6.tar.gz
md5sum = afda97284d75a030cabadf5b9f998a3b
pre-configure = libtoolize && autoreconf --install
environment =
  PATH=${autoconf:location}/bin:${automake:location}/bin:${libtool:location}/bin:${m4:location}/bin:%(PATH)s

[libcroco]
recipe = slapos.recipe.cmmi
shared = true
url = http://ftp.gnome.org/pub/gnome/core/3.20/3.20.2/sources/libcroco-0.6.11.tar.xz
md5sum = dabc1911dfbfa85f8e6859ca47863168
configure-options =
  --disable-static
environment =
  PATH=${pkgconfig:location}/bin:${xz-utils:location}/bin:%(PATH)s
  PKG_CONFIG_PATH=${glib:location}/lib/pkgconfig:${glib:pkg_config_depends}:${libxml2:location}/lib/pkgconfig:${pkgconfig:location}/lib/pkgconfig:${zlib:location}/lib/pkgconfig
  LDFLAGS=-Wl,-rpath=${zlib:location}/lib -Wl,-rpath=${glib:location}/lib

[librsvg]
recipe = slapos.recipe.cmmi
shared = true
url = https://download.gnome.org/sources/librsvg/2.61/librsvg-2.61.3.tar.xz
md5sum = f015a7dca4952ba9a2e3b8b536695f1f
pkg_config_depends = ${pango:location}/lib/pkgconfig:${pango:pkg_config_depends}:${zlib:location}/lib/pkgconfig:${gdk-pixbuf:location}/lib/pkgconfig:${gdk-pixbuf:pkg_config_depends}:${libcroco:location}/lib/pkgconfig
configure-command =
  meson setup builddir --wrap-mode=nodownload --libdir=lib -Dprefix="@@LOCATION@@" -Dintrospection=disabled -Dpixbuf-loader=disabled
make-binary = ninja -C builddir
environment =
  PATH=${cargo-c:location}/bin:${rustc:location}/bin:${meson:location}/bin:${ninja:location}/bin:${gdk-pixbuf:location}/bin:${glib:location}/bin:${libxml2:location}/bin:${pkgconfig:location}/bin:${pango:location}/bin:${xz-utils:location}/bin:%(PATH)s
  PKG_CONFIG_PATH=${:pkg_config_depends}
  LDFLAGS=-L${bzip2:location}/lib -Wl,-rpath=${bzip2:location}/lib -Wl,-rpath=${cairo:location}/lib -Wl,-rpath=${zlib:location}/lib -Wl,-rpath=${glib:location}/lib -Wl,-rpath=${gdk-pixbuf:location}/lib -Wl,-rpath=${libxml2:location}/lib -Wl,-rpath=${pango:location}/lib
  RUSTFLAGS=-C link-arg=-Wl,-rpath=${cairo:location}/lib -C link-arg=-Wl,-rpath=${pango:location}/lib -C link-arg=-Wl,-rpath=${fribidi:location}/lib -C link-arg=-Wl,-rpath=${libxml2:location}/lib -C link-arg=-Wl,-rpath=${glib:location}/lib -C link-arg=-Wl,-rpath=${fontconfig:location}/lib  -C link-arg=-Wl,-rpath=${harfbuzz:location}/lib

[gtk-3]
recipe = slapos.recipe.cmmi
shared = true
# GTK 3.24 is the final stable release of GTK 3.x ( 3.96 etc are already gtk4 )
url = https://download.gnome.org/sources/gtk/3.24/gtk-3.24.51.tar.xz
md5sum = 072b047c25dbd0c383db283fecad98b1
pkg_config_depends = ${at-spi2-atk:location}/lib/pkgconfig:${at-spi2-core:location}/lib/pkgconfig:${atk:location}/lib/pkgconfig:${dbus:location}/lib/pkgconfig:${gdk-pixbuf:location}/lib/pkgconfig:${gdk-pixbuf:pkg_config_depends}:${libXi:pkg_config_depends}:${libXi:location}/lib/pkgconfig:${libXrandr:pkg_config_depends}:${libXrandr:location}/lib/pkgconfig:${libepoxy:location}/lib/pkgconfig:${libxkbcommon:location}/lib/pkgconfig:${libxkbcommon:pkg_config_depends}:${pango:location}/lib/pkgconfig:${pango:pkg_config_depends}:${graphene:location}/lib/pkgconfig:${librsvg:location}/lib/pkgconfig:${libXcursor:location}/lib/pkgconfig:${libXcursor:pkg_config_depends}:${xdamage:location}/lib/pkgconfig
configure-command =
  meson setup builddir --wrap-mode=nodownload --libdir=lib -Dprefix="@@LOCATION@@" -Dintrospection=false -Dwayland_backend=false -Dxinerama=no -Dprint_backends=file -Ddemos=false -Dexamples=false -Dtests=false -Dinstalled_tests=false
make-binary = ninja -C builddir
environment =
  PATH=${cargo-c:location}/bin:${libxml2:location}/bin:${libxslt:location}/bin:${sassc:location}/bin:${gdk-pixbuf:location}/bin:${gettext:location}/bin:${glib:location}/bin:${meson:location}/bin:${ninja:location}/bin:${perl:location}/bin:${pkgconfig:location}/bin:${xz-utils:location}/bin:${python3:location}/bin:%(PATH)s
  PKG_CONFIG_PATH=${:pkg_config_depends}
# not taken from pkg-config result...
  CPPFLAGS=-I${xorgproto:location}/include -I${cairo:location}/include -I${inputproto:location}/include -I${libX11:location}/include -I${libXi:location}/include -I${libXrender:location}/include -I${libXext:location}/include -I${libxkbcommon:location}/include -I${gdk-pixbuf:location}/include -I${libXrandr:location}/include -I${xfixes:location}/include
  LDFLAGS=-L${libXi:location}/lib -L${libXext:location}/lib -L${libXrender:location}/lib -L${bzip2:location}/lib -Wl,-rpath=${bzip2:location}/lib -L${zlib:location}/lib -Wl,-rpath=${zlib:location}/lib -L${libX11:location}/lib -Wl,-rpath=${libX11:location}/lib -L${libxkbcommon:location}/lib -Wl,-rpath=${libxkbcommon:location}/lib -L${gdk-pixbuf:location}/lib -Wl,-rpath=${gdk-pixbuf:location}/lib -L${libXrandr:location}/lib -Wl,-rpath=${libXrandr:location}/lib -L${xfixes:location}/lib -Wl,-rpath=${xfixes:location}/lib -Wl,-rpath=${glib:location}/lib -Wl,-rpath=${atk:location}/lib -Wl,-rpath=${pango:location}/lib -Wl,-rpath=${atk:location}/lib -Wl,-rpath=${gdk-pixbuf:location}/lib -Wl,-rpath=${at-spi2-atk:location}/lib -Wl,-rpath=${at-spi2-core:location}/lib -Wl,-rpath=${cairo:location}/lib -Wl,-rpath=${harfbuzz:location}/lib -Wl,-rpath=${fontconfig:location}/lib -Wl,-rpath=${libXext:location}/lib -Wl,-rpath=${libepoxy:location}/lib -Wl,-rpath=${fribidi:location}/lib -Wl,-rpath=${libXi:location}/lib -Wl,-rpath=${libXcursor:location}/lib -Wl,-rpath=${xdamage:location}/lib -Wl,-rpath=${libpng:location}/lib -Wl,-rpath=${pixman:location}/lib -Wl,-rpath=${libexpat:location}/lib -Wl,-rpath=${dbus:location}/lib -Wl,-rpath=@@LOCATION@@/lib



[gtk4]
# TODO ?
#  meson setup builddir --wrap-mode=nodownload --libdir=lib -Dprefix="@@LOCATION@@" -Dintrospection=disabled -Dwayland-backend=false -Dprint-cups=disabled -Dbuild-demos=false -Dbuild-examples=false -Dbuild-tests=false -Dbuild-testsuite=false -Dmedia-gstreamer=disabled
# 