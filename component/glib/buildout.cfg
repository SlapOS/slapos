[buildout]
extends =
  ../gettext/buildout.cfg
  ../libffi/buildout.cfg
  ../pcre/buildout.cfg
  ../perl/buildout.cfg
  ../xz-utils/buildout.cfg
  ../zlib/buildout.cfg
  ../meson/buildout.cfg
  ../pkgconfig/buildout.cfg
  ../ninja/buildout.cfg

parts =
  glib

[glib]
recipe = slapos.recipe.cmmi
shared = true
url = https://download.gnome.org/sources/glib/2.70/glib-2.70.0.tar.xz
md5sum = 4b08228707d28a9f23f7369902f4b166
configure-command = meson builddir --wrap-mode=nofallback --libdir=lib -Dprefix=@@LOCATION@@
make-binary = ninja -C builddir
environment =
  PATH=${pkgconfig:location}/bin:${ninja:location}/bin:${meson:location}/bin:${gettext:location}/bin:${perl:location}/bin:${xz-utils:location}/bin:%(PATH)s
  PKG_CONFIG_PATH=${gettext:location}/lib/pkgconfig:${zlib:location}/lib/pkgconfig:${libffi:location}/lib/pkgconfig:${pcre:location}/lib/pkgconfig:{xz-utils:location}/lib/pkgconfig
  LDFLAGS=-Wl,-rpath=${pcre:location}/lib
post-install = rm %(location)s/bin/gtester-report

[x86-cygwin-glib]
patches =
  ${:_profile_base_location_}/cygwin-glib-2.28.8-src.patch
