[buildout]
extends =
  ../../component/golang/buildout.cfg
  gowork.cfg

parts =
  gowork
  caddy

[gowork.goinstall]
command = bash -c ". ${gowork:env.sh} && cd ${go_github.com_caddyserver_caddy:location} && GO111MODULE=on go get -v"

[gowork]
golang  = ${golang1.12:location}
install =
  github.com/caddyserver/caddy/...

[caddy]
recipe  = slapos.recipe.cmmi
path    = ${go_github.com_caddyserver_caddy:location}
go      = ${gowork:golang}/bin/go
configure-command = :
make-targets =
make-binary = cd ${:path}/caddy && GO111MODULE=on ${:go} install -v
environment =
  PATH=${pkgconfig:location}/bin:${gowork:golang}/bin:${buildout:bin-directory}:%(PATH)s
  GOPATH=${gowork:directory}
output = ${gowork:bin}/caddy
location = ${:output}
