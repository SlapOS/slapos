# CA certificates

[buildout]

extends =
  ../patch/buildout.cfg
  ../xz-utils/buildout.cfg

parts =
  ca-certificates

[ca-certificates]
recipe = slapos.recipe.cmmi
shared = true
url = http://deb.debian.org/debian/pool/main/c/ca-certificates/ca-certificates_20210119.tar.xz
md5sum = c02582bf9ae338e558617291897615eb
patch-binary = ${patch:location}/bin/patch
patches =
  ${:_profile_base_location_}/ca-certificates-any-python.patch#446a3f164c6b80ad7b63dd0f8662fec0
  ${:_profile_base_location_}/ca-certificates-sbin-dir.patch#0b4e7d82ce768823c01954ee41ef177b
patch-options = -p0
configure-command = true
make-options = DESTDIR=@@LOCATION@@ CERTSDIR=certs SBINDIR=sbin
environment =
  PATH=${xz-utils:location}/bin:%(PATH)s
  PYTHON=${ca-certificates-environment:PYTHON}

[ca-certificates-environment]
recipe = slapos.recipe.
# expose buildout:executable, but in a way that does not directly reference the option,
# because of rebootstrap issues
init =
  import sys
  self.options['PYTHON'] = sys.executable
