# Dovecot
# https://doc.dovecot.org/

[buildout]
extends =
  ../lua/buildout.cfg

[dovecot]
recipe = slapos.recipe.cmmi
url = https://dovecot.org/releases/2.3/dovecot-2.3.20.tar.gz
location = @@LOCATION@@
configure-options =
  --enable-maintainer-mode
  --prefix=${:location}
  --exec-prefix=${:location}
  --with-systemd=no
  --with-lua=yes
environment =
  PATH=${pkgconfig:location}/bin:%(PATH)s
  PKG_CONFIG_PATH=${lua:location}/lib/pkgconfig
  LUA_LIBS="-L${lua:location}/lib -Wl,-rpath=${lua:location}/lib -llua -lm"
  LUA_CFLAGS="-I${lua:location}/include"
make-targets = install
post-install = cp -r ${:location}/share/doc/dovecot/example-config/* ${:location}/etc/dovecot/
