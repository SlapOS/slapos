[buildout]
parts =
  rsyslogd
extends =
  ../curl/buildout.cfg
  ../libestr/buildout.cfg
  ../libfastjson/buildout.cfg
  ../util-linux/buildout.cfg
  ../zlib/buildout.cfg

[rsyslogd]
<= glibc-aware
recipe = slapos.recipe.cmmi
url = https://www.rsyslog.com/files/download/rsyslog/rsyslog-8.2110.0.tar.gz
md5sum = 2d2b9d4a70a6e2fd4a7e806a5782c56b
shared = true
configure-options =
  --disable-klog
  --disable-libgcrypt
  --disable-liblogging-stdlog
  --disable-libsystemd
environment =
  PATH=${pkgconfig:location}/bin:%(PATH)s
  PKG_CONFIG_PATH=${libestr:location}/lib/pkgconfig:${curl:location}/lib/pkgconfig:${libfastjson:location}/lib/pkgconfig:${libuuid:location}/lib/pkgconfig
  CPPFLAGS=-I${libestr:location}/include -I${curl:location}/include -I${libfastjson:location}/include -I${libuuid:location}/include -I${zlib:location}/include
  LDFLAGS=-Wl,-rpath=${libestr:location}/lib -Wl,-rpath=${curl:location}/lib -Wl,-rpath=${libfastjson:location}/lib -Wl,-rpath=${libuuid:location}/lib -L${zlib:location}/lib -Wl,-rpath=${zlib:location}/lib
  ZLIB_CFLAGS=-I${zlib:location}/include
