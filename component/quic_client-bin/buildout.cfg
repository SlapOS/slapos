# Command line tool to test QUIC protocol
# This is compiled version provided by Lucas Clemente (thanks!), which drastically
# simplifies https://www.chromium.org/quic/playing-with-quic approach, which requires
# big chunks of Chromium compilation environment
# XXX: Maybe switch to slapos.recipe.build like ../chromium/buildout.cfg
[buildout]
extends =
# running
  ../nss/buildout.cfg
  ../nspr/buildout.cfg
  ../glib/buildout.cfg
  ../pcre/buildout.cfg
  ../libffi/buildout.cfg
  ../zlib/buildout.cfg
  ../libuuid/buildout.cfg
# compilation
  ../git/buildout.cfg
  
parts =
  quic_client-bin

[quic_client_directory]
recipe = slapos.cookbook:mkdirectory
wrapper-dir = ${buildout:parts-directory}/quic_client

[quic_client-bin]
recipe = slapos.cookbook:wrapper
command-line = ${quic-clients-repository:location}/client-linux-debug
environment =
  LD_LIBRARY_PATH=${nss:location}/lib:${nspr:location}/lib:${glib:location}/lib:${pcre:location}/lib:${libffi:location}/lib:${zlib:location}/lib:${libuuid:location}/lib
wrapper-path = ${:wrapper-dir}/quic_client
wrapper-dir = ${quic_client_directory:wrapper-dir}

[quic-clients-repository]
recipe  = slapos.recipe.build:gitclone
git-executable = ${git:location}/bin/git
repository = https://github.com/lucas-clemente/quic-clients.git
revision = 557cb1f99f591614d474e182b50cfee9334e0ffd
