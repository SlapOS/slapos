[buildout]
extends =
  ../libxml2/buildout.cfg
  ../patch/buildout.cfg
  ../zlib/buildout.cfg

parts =
  libxslt

[libxslt]
url = ftp://xmlsoft.org/libxslt/libxslt-1.1.34.tar.gz
md5sum = db8765c8d076f1b6caafd9f2542a304a
recipe = slapos.recipe.cmmi
shared = true
pre-configure =
  NOCONFIGURE=1 ./autogen.sh
# --disable-static is temporarilly removed due to build error
# with xml2-config that does not support '--dynamic' argument.
configure-options =
  --with-libxml-prefix=${libxml2:location}
  --without-crypto
  --without-python
  --without-debug
  --without-debugger
environment =
  CPPFLAGS=-I${zlib:location}/include
  LDFLAGS=-L${zlib:location}/lib -Wl,-rpath=${zlib:location}/lib
  PATH=${patch:location}/bin:%(PATH)s
patches =
  https://gitlab.gnome.org/GNOME/libxslt/-/commit/9ae2f94df1721e002941b40665efb762aefcea1a.diff#31061280e6d0bd517e35489818aef92c
  https://gitlab.gnome.org/GNOME/libxslt/-/commit/824657768aea2cce9c23e72ba8085cb5e44350c7.diff#37d121f9ebd82f402fe794524aa67a58
  https://gitlab.gnome.org/GNOME/libxslt/-/commit/77c26bad0433541f486b1e7ced44ca9979376908.diff#fd661202e2b6d8279a8026bba503f87e
patch-options =
  -p1
