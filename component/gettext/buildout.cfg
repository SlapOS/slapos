[buildout]
parts =
  gettext
extends =
  ../libxml2/buildout.cfg
  ../lunzip/buildout.cfg
  ../ncurses/buildout.cfg
  ../perl/buildout.cfg
  ../zlib/buildout.cfg
  ../patch/buildout.cfg

[gettext]
recipe = slapos.recipe.cmmi
url = http://ftp.gnu.org/pub/gnu/gettext/gettext-0.19.8.1.tar.lz
md5sum = d838d2c4144261d0c5fbab4a0aceb5c1

#pre-configure = 
#  cp -a  ${readline6.3-config_sub:location}/config.sub   ${readline:location}__compile__/readline-${readline:version}/support

configure-options =
  --disable-static
  --disable-java
  --disable-native-java
  --disable-csharp
  --with-libncurses-prefix=${ncurses:location}
  --with-libxml2-prefix=${libxml2:location}
  --with-included-gettext
  --without-emacs
  --disable-acl
  --disable-openmp
  --without-git
  --without-bz2
  --without-xz
  CFLAGS="$CFLAGS -O2"
  CXXFLAGS="$CXXFLAGS -O2"

patch-options = -p3  
patches = 
#  https://raw.githubusercontent.com/Alexpux/MSYS2-packages/master/gettext/0.19.8.1-autopoint-V.patch
#  https://raw.githubusercontent.com/Alexpux/MSYS2-packages/master/gettext/0.19.8.1-cygwin-ftm.patch
  https://raw.githubusercontent.com/Alexpux/MSYS2-packages/master/gettext/0.19.8.1-localename.patch
#  https://raw.githubusercontent.com/Alexpux/MSYS2-packages/master/gettext/0.19.8.1-no-woe32dll.patch
#  https://raw.githubusercontent.com/Alexpux/MSYS2-packages/master/gettext/0.19.8.1-tests-cygwin.patch
  https://raw.githubusercontent.com/Alexpux/MSYS2-packages/master/gettext/0.19.8.1-have_wprintf.patch
#  ${:_profile_base_location_}/0.19.8.1-autopoint-V.patch
#  ${:_profile_base_location_}/https://raw.githubusercontent.com/Alexpux/MSYS2-packages/master/gettext/0.19.8.1-cygwin-ftm.patch
#  ${:_profile_base_location_}/0.19.8.1-have_wprintf.patch
#  ${:_profile_base_location_}/0.19.8.1-localename.patch
#  ${:_profile_base_location_}/0.19.8.1-no-woe32dll.patch
#  ${:_profile_base_location_}/0.19.8.1-tests-cygwin.patch
  
environment =
  PATH=${perl:location}/bin:${lunzip:location}/bin:${patch:location}/bin:%(PATH)s
  CPPFLAGS=-I${libxml2:location}/include -I${zlib:location}/include -I${ncurses:location}/include
  LDFLAGS=-L${libxml2:location}/lib -Wl,-rpath=${libxml2:location}/lib -L${zlib:location}/lib -Wl,-rpath=${zlib:location}/lib -L${ncurses:location}/lib -Wl,-rpath=${ncurses:location}/lib
