[buildout]
extends =
  ../zlib/buildout.cfg
  ../cmake/buildout.cfg
  ../perl/buildout.cfg
  ../pkgconfig/buildout.cfg
parts =
  hdf5

[hdf5]
recipe = slapos.recipe.cmmi
shared = true

[hdf5:python3]
url = https://github.com/HDFGroup/hdf5/releases/download/2.0.0/hdf5-2.0.0.tar.gz
md5sum = 801597eccdf74d7304444fdc18652b75
configure-command = mkdir build ; cd build ; ${cmake:location}/bin/cmake ..
configure-options = 
 -DCMAKE_INSTALL_PREFIX=%(location)s
 -DHDF5_ENABLE_ZLIB_SUPPORT:BOOL=ON
 -DCMAKE_INSTALL_RPATH=${zlib:location}/lib/
 -DZLIB_LIBRARY=${zlib:location}/lib/libz.so
 -DZLIB_INCLUDE_DIR=${zlib:location}/include
make-binary = cd build && make
environment =
  PATH=${cmake:location}/bin:${perl:location}/bin:${pkgconfig:location}/bin:%(PATH)s
  PKG_CONFIG_PATH=${zlib:location}/lib/pkgconfig

[hdf5:python2]
url = https://support.hdfgroup.org/ftp/HDF5/releases/hdf5-1.10/hdf5-1.10.0-patch1/src/hdf5-1.10.0-patch1.tar.bz2
md5sum = f6d980febe2c35c11670a9b34fa3b487
configure-options =
  --with-zlib=${zlib:location}
environment =
  CPPFLAGS=-I${zlib:location}/include
  LDFLAGS=-L${zlib:location}/lib -Wl,-rpath=${zlib:location}/lib

