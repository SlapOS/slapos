# helloweb - programs to say hello to the Web in various languages
[buildout]
extends =
  ../git/buildout.cfg
  ../ruby/buildout.cfg

parts =
  helloweb-python
  helloweb-ruby


# repository with examples
[helloweb-repository]
recipe  = slapos.recipe.build:gitclone
git-executable = ${git:location}/bin/git
repository = https://lab.nexedi.com/kirr/helloweb.git
#revision = TODO
branch = x
location = ${buildout:parts-directory}/helloweb


# -*- python -*-
[helloweb-egg]
recipe  = zc.recipe.egg:develop
egg     = helloweb
setup   = ${helloweb-repository:location}/python/

# XXX bin/helloweb -> bin/helloweb-python
[helloweb-python]
recipe  = zc.recipe.egg:scripts
eggs    = ${helloweb-egg:egg}
# scripts = helloweb=helloweb-python
scripts = helloweb


# -*- ruby -*-

# bundler, that we'll use to install gems and run binaries (via `bundle exec ...`)
[bundler]
# rubygemsrecipe with fixed url and this way pinned rubygems version
recipe  = rubygemsrecipe
url     = https://rubygems.org/rubygems/rubygems-2.4.8.zip
ruby-executable = ${ruby2.1:location}/bin/ruby
gems    = bundler==1.10.6

# bin installed here
bundle  = ${buildout:bin-directory}/bundle


[helloweb-ruby/bundle]
recipe  = slapos.recipe.cmmi
path    = ${helloweb-repository:location}/ruby/

configure-command = :
make-binary =
make-targets= cd ${:path} && ${bundler:bundle} install


# XXX stub
[helloweb-ruby]
recipe  = plone.recipe.command
command = :
depends = ${helloweb-ryby/bundle}
