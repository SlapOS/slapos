[buildout]
extends =
  ../gdbm/buildout.cfg
  ../patch/buildout.cfg
parts =
  perl

[perl]
recipe = slapos.recipe.cmmi
shared = true
version = 5.26.1
url = http://www.cpan.org/src/5.0/perl-${:version}.tar.bz2
md5sum = 467cd0c43514b9b5e397c8b385581f53
;siteprefix = ${buildout:parts-directory}/site_${:_buildout_section_name_}
; XXX is this correct ??
siteprefix = @@LOCATION@@/site_${:_buildout_section_name_}
patch-options = -p1
patches =
  ${:_profile_base_location_}/perl-keep-linker-flags-in-ldflags.patch#4e8e0c59d7176eafb0c7402dea17bef1
configure-command =
  sh Configure -des \
    -Dprefix=@@LOCATION@@ \
    -Dsiteprefix=${:siteprefix} \
    -Dcflags=-I${gdbm:location}/include \
    -Dldflags="-L${gdbm:location}/lib -Wl,-rpath=${gdbm:location}/lib" \
    -Ui_db \
    -Dnoextensions=ODBM_File \
    -Dusethreads
environment =
  PATH=${patch:location}/bin:%(PATH)s
post-make-hook = ${:_profile_base_location_}/perl-create-libs-symlink.py#943453b7d3ff8d49ed12d44a7f7076ee:post_make_hook
