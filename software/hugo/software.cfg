[buildout]
extends =
  ../../component/hugo/buildout.cfg
  ../../component/nginx/buildout.cfg
  ../../component/dash/buildout.cfg
  buildout.hash.cfg

parts =
  slapos-cookbook
  nginx
  hugo
  template-cfg
  extra-eggs

[profile-common]
nginx_location = ${nginx:location}
dash_location = ${dash:location}
template_nginx_conf = ${template_nginx_conf:target}
template_mime_types = ${template_mime_types:target} 
template_launcher = ${template_launcher:target}

[template-cfg]
recipe = slapos.recipe.template:jinja2
rendered = ${buildout:directory}/template.cfg
template = ${:_profile_base_location_}/${:filename}
# filename = instance.cfg.in
# md5sum = 5a6ebc126bcad3cdff1b51fb51f82a35
mode = 0644
context =
  section buildout buildout
  section parameter_list profile-common

# [instance-cfg]
#recipe = slapos.recipe.template
#url = ${:_profile_base_location_}/${:filename}
#output = ${buildout:directory}/instance.cfg

[template_nginx_conf]
recipe = slapos.recipe.build:download
url = ${:_profile_base_location_}/${:_update_hash_filename_}
_update_hash_filename_ = templates/nginx_conf.in
# md5sum = 61dc4c82bf48563228ce4dea6c5c6319
mode = 0644

[template_launcher]
recipe = slapos.recipe.build:download
url = ${:_profile_base_location_}/${:_update_hash_filename_}
_update_hash_filename_ = templates/launcher.in
# md5sum = 6cb0d64905ae7fc67277c1bf76b86875
mode = 0644

[template_mime_types]
recipe = slapos.recipe.build:download
url = ${:_profile_base_location_}/${:_update_hash_filename_}
_update_hash_filename_ = templates/mime_types.in
# md5sum = 4ef94a7b458d885cd79ba0b930a5727e
mode = 0644

[extra-eggs]
recipe  = zc.recipe.egg
eggs    =
    plone.recipe.command

# Pin versions of eggs used that are not already pinned by stack/slapos.cfg
[versions]
slapos.recipe.template = 4.4
