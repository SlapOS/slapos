[buildout]
extends =
  buildout.hash.cfg
  ../../component/hugo/buildout.cfg
  ../../component/nginx/buildout.cfg
  ../../component/dash/buildout.cfg
  ../../component/tar/buildout.cfg
  ../../component/curl/buildout.cfg
  ../../stack/slapos.cfg
  ../../stack/monitor/buildout.cfg

parts =
  slapos-cookbook
  hugo
  template-cfg

[template-cfg]
recipe = slapos.recipe.template:jinja2
rendered = ${buildout:directory}/template.cfg
template = ${:_profile_base_location_}/${:filename}
mode = 0644
context =
  section buildout buildout
  key nginx_location nginx:location
  key dash_location dash:location
  key curl_location curl:location
  key tar_location tar:location
  key go_environment gowork:env.sh
  key template_nginx_conf_target template_nginx_conf:target
  key template_mime_types_target template_mime_types:target
  key template_launcher_target template_launcher:target
  key template_instance_dev_target instance_dev:target
  key template_index_html_target template_index_html:target
  key template_graceful_target template_graceful:target
  key template_instance_pro template_instance_pro:target
  key template_monitor monitor2-template:rendered
  key template_server_target template_server:target
  key template_hugo_graceful_target template_hugo_graceful:target

[download-base]
recipe = slapos.recipe.build:download
url = ${:_profile_base_location_}/${:_update_hash_filename_}
mode = 0644

[instance_dev]
<= download-base

[template_nginx_conf]
<= download-base

[template_launcher]
<= download-base

[template_mime_types]
<= download-base

[template_graceful]
<= download-base

[template_index_html]
<= download-base

[template_instance_pro]
<= download-base

[template_server]
<= download-base

[template_hugo_graceful]
<= download-base
