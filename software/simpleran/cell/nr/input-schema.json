{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "NR Cell",
  "type": "object",
  "required": [
    "cell_type",
    "rf_mode",
    "pci",
    "cell_id",
    "bandwidth",
    "ru",
    "dl_nr_arfcn",
    "nr_band"
  ],
  "allOf": [{ "$ref": "../../cell/common.json" }],
  "properties": {
    "cell_type": {
      "$ref": "../../cell/common.json#/$defs/cell_type",
      "const": "nr"
    },
    "tdd_ul_dl_config": {
      "title": "TDD Configuration",
      "description": "Define the TDD UL/DL configuration.",
      "anyOf": [
        {
          "title": "Pre-defined configurations",
          "type": "string",
          "enum": [
            "DDDDDDDSUU (5ms,   7DL/2UL), S-slot=6DL:4GP:4UL, default",
            "DDDSUUDDDD (5ms,   7DL/2UL), S-slot=6DL:4GP:4UL, same ratios as default",
            "DDDSUUUUDD (5ms,   5DL/4UL), S-slot=6DL:4GP:4UL, balanced downlink and uplink",
            "DDDSUUUUUU (5ms,   3DL/6UL), S-slot=2DL:2GP:10UL, high uplink",
            "DDSUUUUUUU (5ms,   2DL/7UL), S-slot=6DL:4GP:4UL, EXPERIMENTAL very high uplink",
            "DSUUUUUUUU (5ms,   1DL/8UL), S-slot=10DL:2GP:2UL, EXPERIMENTAL maximum uplink",
            "DDDSU      (2.5ms, 3DL/1UL), S-slot=10DL:2GP:2UL, reduced latency"
          ]
        },
        {
          "title": "Expert only: manual configuration",
          "type": "object",
          "required": [
            "pattern1"
          ],
          "additionalProperties": false,
          "properties": {
            "pattern1": {
              "$ref": "#/$defs/pattern",
              "title": "First TDD Pattern",
              "description": "Definition of the first TDD pattern."
            },
            "pattern2": {
              "$ref": "#/$defs/pattern",
              "title": "Second TDD Pattern (optional)",
              "description": "Definition of the second TDD pattern."
            }
          }
        }
      ],
      "default": "DDDDDDDSUU (5ms,   7DL/2UL), S-slot=6DL:4GP:4UL, default",
      "options": {
        "dependencies": {
          "rf_mode": "tdd"
        }
      }
    },
    "bandwidth": {
      "$ref": "../../cell/common.json#/$defs/bandwidth"
    },
    "dl_nr_arfcn": {
      "title": "DL NR ARFCN",
      "description": "Downlink NR Absolute Radio Frequency Channel Number of the cell",
      "type": "integer"
    },
    "nr_band": {
      "title": "NR band",
      "description": "NR band number",
      "type": "integer"
    },
    "ul_nr_arfcn": {
      "title": "UL NR ARFCN",
      "description": "Uplink NR Absolute Radio Frequency Channel Number of the cell. By default a frequency corresponding to dl_nr_arfcn and nr_band is chosen.",
      "type": "integer"
    },
    "ssb_nr_arfcn": {
      "title": "SSB NR ARFCN",
      "description": "SSB NR Absolute Radio Frequency Channel Number of the cell. If set it must be an element of global synchronization raster and be at offset from center DL frequency that aligns with SSB subcarrier spacing of selected band. By default a valid frequency nearby dl_nr_arfcn is chosen.",
      "type": "integer"
    },
    "ssb_pos_bitmap": {
      "title": "SSB Position Bitmap",
      "description": "SSB position bitmap in bits (4, 8 or 64 bits depending on the DL frequency).",
      "type": "string"
    },
    "root_sequence_index": {
      "$ref": "../../cell/common.json#/$defs/root_sequence_index",
      "description": "Range 0 to 837 for PRACH format up to 3, 0 to 137 otherwise. prach-RootSequenceIndex parameter. It must be different for each neighbour cell operating on the same frequency and sharing the same PRACH configuration.",
      "default": 1
    },
    "cipher_algo_pref": {
      "title": "Preferred Cipher algorithms",
      "decription": "Set the preferred algorithms for RRC and User Plane encryption in decreasing order of preference. If none match the UE capabilities, then NEA0 (no encryption) is selected",
      "type": "array",
      "items": {
        "type": "string",
        "title": "Algorithm preference",
        "enum": [
          "NEA1 (Snow 3G)",
          "NEA2 (128 bit AES)",
          "NEA3 (ZUC)"
        ]
      },
      "default": []
    },
    "integ_algo_pref": {
      "title": "Preferred Integrity algorithms",
      "decription": "Set the preferred algorithms for RRC integrity (and optionally User Plane integrity) check in decreasing order of preference. If none match the UE capabilities, then NIA0 (no integrity check) is selected. (Default: NIA2, NIA1)",
      "type": "array",
      "items": {
        "type": "string",
        "title": "Algorithm preference",
        "enum": [
          "NIA1 (Snow 3G)",
          "NIA2 (128 bit AES)",
          "NIA3 (ZUC)"
        ]
      },
      "default": ["NIA2 (128 bit AES)","NIA1 (Snow 3G)"]
    }
  },
  "$defs": {
    "tac": {
      "title": "Tracking Area Code",
      "description": "Tracking Area Code (range: 0x0001 to 0xffffff except 0xfffffe, format: integer or hexadecimal starting by 0x)",
      "type": "string"
    },
    "pattern": {
      "type": "object",
      "required": [
        "period",
        "dl_slots",
        "ul_slots",
        "dl_symbols",
        "ul_symbols"
      ],
      "additionalProperties": false,
      "properties": {
        "period": {
          "title": "Period",
          "description": "DL/UL transmission periodicity in ms.",
          "type": "number",
          "enum": [
            "0.5",
            "0.625",
            "1",
            "1.25",
            "2",
            "2.5",
            "3",
            "4",
            "5",
            "10"
          ]
        },
        "dl_slots": {
          "title": "Downlink Slots",
          "description": "Number of downlink slots.",
          "type": "number"
        },
        "ul_slots": {
          "title": "Uplink Slots",
          "description": "Number of uplink slots.",
          "type": "number"
        },
        "dl_symbols": {
          "title": "Downlink Symbols",
          "description": "Number of downlink symbols after the last complete downlink slot.",
          "type": "number"
        },
        "ul_symbols": {
          "title": "Uplink Symbols",
          "description": "Number of uplink symbols before the first complete uplink slot.",
          "type": "number"
        }
      },
      "default": 1
    }
  }
}
