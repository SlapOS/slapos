[buildout]

extends =
  buildout.hash.cfg
  ../../stack/monitor/buildout.cfg
  ../../component/replication-manager/buildout.cfg
  ../../component/mariadb/buildout.cfg
  ../../component/git/buildout.cfg
  ../../stack/monitor/buildout.cfg
  ../../stack/slapos.cfg

parts =
  slapos-cookbook
  instance.cfg
  mariadb
  repman
  repman-repository


[instance.cfg]
recipe  = slapos.recipe.template
url     = ${:_profile_base_location_}/${:filename}
output  = ${buildout:directory}/instance.cfg

[repman-repository]
recipe  = slapos.recipe.build:gitclone
git-executable = ${git:location}/bin/git
location = ${buildout:directory}/src
branch = 2.1
repository = https://github.com/signal18/replication-manager

[download-file]
recipe  = slapos.recipe.build:download
url     = ${:_profile_base_location_}/${:_update_hash_filename_}
destination = ${buildout:directory}/${:_buildout_section_name_}

[config-toml.in]
<= download-file

[instance-repman.cfg]
<= download-file

# Pin versions of eggs used that are not already pinned by stack/slapos.cfg
[versions]
slapos.recipe.template = 4.3
rubygemsrecipe  = 0.2.2+slapos001