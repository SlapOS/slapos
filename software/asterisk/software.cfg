[buildout]
extends =
  buildout.hash.cfg
  ../../stack/slapos.cfg
  ../../component/asterisk/buildout.cfg
  ../../stack/monitor/buildout.cfg

parts =
  instance.cfg
  instance.json
  slapos-cookbook

[instance.cfg]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/${:filename}
output = ${buildout:directory}/instance.cfg

[extensions.conf.in]
recipe = slapos.recipe.build:download
url = ${:_profile_base_location_}/${:filename}

[directory]
recipe = slapos.recipe.build:mkdirectory
json-schema = ${buildout:directory}/json-schema

[download-json-base]
recipe = slapos.recipe.build:download
url = ${:_profile_base_location_}/${:filename}
destination = ${directory:json-schema}/${:filename}

[software.json]
<= download-json-base

[instance.json]
<= download-json-base
