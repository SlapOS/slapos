[buildout]
extends =
  software.cfg

[sqdr-source]
recipe = slapos.recipe.build:gitclone
repository = https://lab.nexedi.com/slaposdrone/squadrone.git
revision = a34dd6b
git-executable = ${git:location}/bin/git

[sqdr-wrapper]
recipe = slapos.recipe.cmmi
configure-command = true
path = ${sqdr-source:location}
environment =
  CPLUS_INCLUDE_PATH=include:${autopilot-wrapper-header:location}
  LDFLAGS=-Llib -Wl,-rpath=lib

[qjs-wrapper]
recipe = slapos.recipe.cmmi
configure-command = true
environment =
  C_INCLUDE_PATH=include:${open62541:location}/include:${open62541:location}/deps:${open62541:location}/src/pubsub:${quickjs:location}/include:${autopilot-wrapper-header:location}
  LDFLAGS=-L${open62541:location}/lib -Wl,-rpath=${open62541:location}/lib -L${sqdr-wrapper:location}/lib -Wl,-rpath=${sqdr-wrapper:location}/lib
