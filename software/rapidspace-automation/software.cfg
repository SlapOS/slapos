# It's a hack around to bootstrap rapidspace-automation
# All here shall be part of slapos-node package
[buildout]
extends =
  ../../component/defaults.cfg
  ../../stack/slapos.cfg
  ../../component/curl/buildout.cfg
  ../../component/openssl/buildout.cfg

parts =
  automation-eggs
  automation-bin

[automation-eggs]
recipe = zc.recipe.egg
eggs =
  ${python-cryptography:egg}
  ${python-cffi:egg}
  ${lxml-python:egg}
  ${python-PyYAML:egg}
  slapos.libnetworkcache
  ansible-core
  slapos.core
interpreter = ansible-python

[automation-bin]
recipe = plone.recipe.command
update-command = ${:command}
stop-on-error = True
destination = ${buildout:bin-directory}
links =
  ${openssl:location}/bin/openssl
  ${openssl:location}/bin/c_rehash
  ${curl-http3:location}/bin/curl
command =
  for f in "${:links}" ; do
    ln -sf $f ${:destination}
  done

[versions]
ansible-core = 2.15.13:whl
resolvelib = 1.0.1:whl
