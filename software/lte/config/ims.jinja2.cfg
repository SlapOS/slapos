/* lteims configuration file
 * version 2021-09-18
 * Copyright (C) 2015-2021 Amarisoft
 */
{
    log_options: "all.level=debug,all.max_size=32",
    log_filename: "{{ directory['log'] }}/ims.log",

    /* SIP bind address */
    //sip_addr: [
    //    {addr: "192.168.4.1", bind_addr: "192.168.4.1", port_min: 10000, port_max: 20000},
    //    "2001:468:3000:1::",
    //    {addr: "192.168.5.1", bind_addr: "192.168.5.1", port_min: 10000, port_max: 20000},
    //    "2001:468:4000:1::"
    //],
    /* SIP bind address */
    sip_addr: [
        {addr: "{{ instance['tun-ipv4-addr'] }}", bind_addr: "0.0.0.0", port_min: 10000, port_max: 20000},
        {#" instance['tun-ipv6-addr'] ",#}
    ],

    mms_server_bind_addr: "{{ netaddr.IPAddress(netaddr.IPNetwork(instance['tun-ipv4-network']).first) + 1 }}:1111",

    /* MME connection for SMS over SG */
    sctp_addr: "{{ instance['configuration.ims_addr'] }}",

    /* Cx connection */
    cx_server_addr: "127.0.1.100",
    cx_bind_addr: "{{ instance['configuration.ims_addr'] }}",

    /* Rx connection */
    rx_server_addr: "127.0.1.100",
    rx_bind_addr: "{{ instance['configuration.ims_addr'] }}",

    /* Remote API */
    com_addr: "[{{ instance['ipv6-random'] }}]:{{ instance['configuration.ims_ws_port'] }}",

    /* Global domain name (May be overriden for each user) */
    domain: "{{ instance['configuration.domain'] }}",

{% if instance.get("ue_db_path") %}
    include "{{ instance.get("ue_db_path") }}",
{% else %}
    /* user data base */
    include "{{ directory['software'] }}/mme/config/ue_db-ims.cfg",
{% endif %} 

{# Example of of s6a connection #}
{#  s6: { #}
{#    server_addr: "", #}
{#    bind_addr: "", #}
{#    origin_realm: "", #}
{#    origin_host: "", #}
{#  }, #}

    /* Echo phone number */
    echo: [
        "tel:666",
        "tel:+666",
        {impu: "tel:404", code: 404},     /* 404 test */
        {impu: "urn:service:sos", anonymous: true, authentication: false}, /* Emergency call */
        {impu: "urn:service:sos.police", anonymous: true, authentication: false}, /* Emergency call */
    ],

    /* Delay */
    //sms_expires: 86400,
    //binding_expires: 3600,

    /* on: 3GPP mode allowed
     * silent: 3GPP mode forced
     * off: IETF mode
     */
    precondition: "on",
    "100rel": true,

    /* IPsec */
    ipsec_aalg_list: ["hmac-md5-96", "hmac-sha-1-96"],
    ipsec_ealg_list: ["null", "aes-cbc", "des-cbc", "des-ede3-cbc"],

    mt_call_sdp_file: "{{ directory['software'] }}/mme/config/mt_call.sdp",

    ue_db_filename: "{{ directory['var'] }}/lte_ue_ims.db",
}
