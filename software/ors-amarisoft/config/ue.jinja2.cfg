{#- do_lte/do_nr indicate whether we have LTE or NR UE/cells #}
{%- do assert(do_lte or do_nr)  %}
{%- do assert(not (do_lte and do_nr))  %}

{
  log_options: "all.level=error,all.max_size=0,nas.level=debug,nas.max_size=1,rrc.level=debug,rrc.max_size=1,phy.level=info,file.rotate=1G,file.path=/dev/null",
  log_filename: "{{ directory['log'] }}/ue.log",

  rue_bind_addr: "{{ pub_info['rue_bind_addr'] }}",
  com_addr: "{{ pub_info['com_addr'] }}",

rf_driver: {
    name: "sdr",
    args: "dev0=/dev/sdr0",
    rx_antenna:"tx_rx",
},
  tx_gain: {{ slapparameter_dict.get('tx_gain', 60) }},
  rx_gain: {{ slapparameter_dict.get('rx_gain', 40) }},
  cell_groups: [
{%- if do_lte %}
  {
    // LTE cell
    multi_ue: true,
    cells: [
      {
        bandwidth: {{ slapparameter_dict.get('bandwidth', default_lte_bandwidth) .removesuffix(' MHz') }},
        dl_earfcn: {{ slapparameter_dict.get('dl_earfcn', 0) }},
        n_antenna_dl: {{ slapparameter_dict.get('n_antenna_dl', default_n_antenna_dl) }},
        n_antenna_ul: {{ slapparameter_dict.get('n_antenna_ul', default_n_antenna_ul) }},
        global_timing_advance: -1,
      }
    ],
    pdcch_decode_opt: false,
    pdcch_decode_opt_threshold: 0.1,
  },
{%- endif %}
{%- if do_nr  %}
  {
    // NR cell
    group_type: "nr",
    multi_ue: false,
    cells: [{
      rf_port: 0,
      bandwidth: {{ slapparameter_dict.get('bandwidth', default_nr_bandwidth) }},
      band: {{ slapparameter_dict.get('nr_band', 0) }},
      dl_nr_arfcn: {{ slapparameter_dict.get('dl_nr_arfcn', 0) }},
      ssb_nr_arfcn: {{ slapparameter_dict.get('ssb_nr_arfcn', 0) }},
      subcarrier_spacing: 30,
      n_antenna_dl: {{ slapparameter_dict.get('n_antenna_dl', default_n_antenna_dl) }},
      n_antenna_ul: {{ slapparameter_dict.get('n_antenna_ul', default_n_antenna_ul) }},
      }
    ],
  },
{%- endif %}
  ],
  ue_list: [
    {
    sim_algo: "{{ slapparameter_dict.get('sim_algo', 'milenage') }}",
    opc: "{{ slapparameter_dict.get('opc', '') }}",
    amf: {{ slapparameter_dict.get('amf', '0x9001') }},
    sqn: "{{ slapparameter_dict.get('sqn', '000000000000') }}",
    impu: "{{ slapparameter_dict.get('impu', '') }}",
    impi: "{{ slapparameter_dict.get('impi', '') }}",
    imsi: "{{ slapparameter_dict.get('imsi', default_imsi) }}",
    K: "{{ slapparameter_dict.get('k', default_k) }}",
{%- if do_lte %}
    ue_category: 12,
{%- endif %}
{%- if do_nr  %}
    as_release: 15,
    ue_category: "nr",
{%- endif %}
    rue_addr: "{{ slapparameter_dict.get('rue_addr', '') }}",
    tun_setup_script: "ue-ifup",
    apn: "internet",
    }
  ],
}
