[buildout]
extends =
  buildout.hash.cfg
  ../../stack/slapos.cfg
  ../../stack/monitor/buildout.cfg
  ../../component/logrotate/buildout.cfg
  ../../component/nghttp2/buildout.cfg
  ../../component/iperf3/buildout.cfg

parts +=
  template
  slapos-cookbook
  ltelogs.jinja2.sh
# copy all configs by default
  mme.jinja2.cfg
  ims.jinja2.cfg
  enb.jinja2.cfg
  gnb.jinja2.cfg
  ue_db.jinja2.cfg
  sib23.asn
  iperf3
# unimplemented parts - the http monitor and better log handling using logrotate
#  apache-php
#  logrotate


[template]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/${:filename}
output = ${buildout:directory}/template.cfg

[download-base]
recipe = slapos.recipe.build:download
url = ${:_profile_base_location_}/${:_update_hash_filename_}

[template-lte-enb-epc]
<= download-base

[template-lte-gnb-epc]
<= download-base

[template-lte-epc]
<= download-base

[template-lte-enb]
<= download-base

[template-lte-gnb]
<= download-base

[template-lte-mme]
<= download-base

[sdr-busy-promise]
<= download-base

[interface-up-promise]
<= download-base

[copy-to-instance]
recipe  = slapos.recipe.build:download
url     = ${:_profile_base_location_}/${:_buildout_section_name_}

[copy-config-to-instance]
recipe  = slapos.recipe.build:download
url     = ${:_profile_base_location_}/config/${:_buildout_section_name_}

[enb.jinja2.cfg]
<= copy-config-to-instance
filename = enb.jinja2.cfg
[sib23.asn]
<= copy-config-to-instance
filename = sib23.asn
[gnb.jinja2.cfg]
<= copy-config-to-instance
filename = gnb.jinja2.cfg
[ltelogs.jinja2.sh]
<= copy-to-instance
filename = ltelogs.jinja2.sh
[ue_db.jinja2.cfg]
<= copy-config-to-instance
filename = ue_db.jinja2.cfg
[mme.jinja2.cfg]
<= copy-config-to-instance
filename = mme.jinja2.cfg
[ims.jinja2.cfg]
<= copy-config-to-instance
filename = ims.jinja2.cfg
