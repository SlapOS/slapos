[buildout]
parts =
  directory
eggs-directory = {{ buildout['eggs-directory'] }}
develop-eggs-directory = {{ buildout['develop-eggs-directory'] }}
offline= true

[directory]
recipe = slapos.cookbook:mkdirectory
etc = $${buildout:directory}/etc
var = $${buildout:directory}/var
srv = $${buildout:directory}/srv
bin = $${buildout:directory}/bin
tmp = $${buildout:directory}/tmp
usr = $${buildout:directory}/usr
run = $${:etc}/run
service = $${:etc}/service

[slap-configuration]
recipe = slapos.cookbook:slapconfiguration
computer = $${slap-connection:computer-id}
partition = $${slap-connection:partition-id}
url = $${slap-connection:server-url}
key = $${slap-connection:key-file}
cert = $${slap-connection:cert-file}

[dovecot.conf]
recipe = slapos.recipe.template:jinja2
extensions = jinja2.ext.do
url = {{ dovecot_conf_template }}
context =
  section directory directory
  key ipv6 slap-configuration:ipv6-random
