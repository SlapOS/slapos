[buildout]
extends =
  ../../component/xz-utils/buildout.cfg
  ../../component/postfix/buildout.cfg
  ../../stack/monitor/buildout.cfg
  ../../stack/slapos.cfg
  buildout.hash.cfg

parts =
  slapos-cookbook
  template
  dovecot


[dovecot]
recipe = slapos.recipe.cmmi
url = https://dovecot.org/releases/2.3/dovecot-2.3.20.tar.gz
location = @@LOCATION@@
configure-command = ./configure
configure-options =
  --prefix=${:location}
make-targets = install
post-install = cp -r ${:location}/share/doc/dovecot/example-config/* ${:location}/etc/dovecot/

[template]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/${:filename}
output = ${buildout:directory}/template.cfg

[template-postfix]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/${:filename}
output = ${buildout:directory}/instance-postfix.cfg.jinja2

[template-dovecot]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/${:filename}
output = ${buildout:directory}/instance-dovecot.cfg

[download-base]
recipe = slapos.recipe.build:download
url = ${:_profile_base_location_}/${:filename}

[template-postfix-master-cf]
< = download-base

[template-postfix-main-cf]
< = download-base

[template-postfix-aliases]
< = download-base

[template-dovecot-main-conf]
< = download-base

