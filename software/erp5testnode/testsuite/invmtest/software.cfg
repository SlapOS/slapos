[buildout]
extends =
  buildout.hash.cfg
  ../../../../component/gzip/buildout.cfg
  ../../../kvm/software.cfg
parts =
  python-with-eggs
  template-invmtest
  runTestSuite_py

[runTestSuite_py]
recipe = zc.recipe.egg
eggs =
  erp5.util
  requests
interpreter = ${:_buildout_section_name_}

[test-location]
base = ${slapos-package:location}

[slapos-package]
recipe = slapos.recipe.build:gitclone
repository = https://lab.nexedi.com/nexedi/slapos.package.git
branch = cdn-test
git-executable = ${git:location}/bin/git

[template]
output = ${buildout:directory}/template-original.kvm.cfg

[deploy-script-controller-script]
location = ${:_profile_base_location_}/${:filename}

[template-invmtest]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/${:filename}
output = ${buildout:directory}/template.cfg

[download]
recipe = slapos.recipe.build:download
url = ${:_profile_base_location_}/${:filename}

[instance-invmtest.cfg.jinja2]
<= download

[versions]
erp5.util = 0.4.69
