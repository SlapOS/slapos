[buildout]
extends =
  buildout.hash.cfg
  ../../stack/caucase/buildout.cfg
  ../../stack/slapos.cfg

parts +=
  template

[template-render-base]
recipe = slapos.recipe.template:jinja2
template = ${:_profile_base_location_}/${:filename}
rendered = ${buildout:directory}/${:_buildout_section_name_}.cfg
mode = 0644
context =
  section software_parameter_dict software-parameter-section
  ${:extra-context}
extra-context =

[template]
<= template-render-base

[template-common]
<= template-render-base

[template-download-base]
recipe = slapos.recipe.build:download
url = ${:_profile_base_location_}/${:filename}
mode = 0644

[template-rapid-cdn-cluster]
<= template-download-base

[template-rapid-cdn-human]
<= template-download-base

[template-rapid-cdn-kedifa]
<= template-download-base

[template-rapid-cdn-log-aggregator]
<= template-download-base

[template-rapid-cdn-frontend]
<= template-download-base

[software-parameter-section]
# software parameters
develop_eggs_directory = ${buildout:develop-eggs-directory}
eggs_directory = ${buildout:eggs-directory}

# libraries
caucase_jinja2_library = ${caucase-jinja2-library:target}

# templates
template_common = ${template-common:rendered}
template_monitor2 = ${monitor2-template:rendered}
template_rapid_cdn_frontend = ${template-rapid-cdn-frontend:target}
template_rapid_cdn_cluster = ${template-rapid-cdn-cluster:target}
template_rapid_cdn_human = ${template-rapid-cdn-human:target}
template_rapid_cdn_kedifa = ${template-rapid-cdn-kedifa:target}
template_rapid_cdn_log_aggregator = ${template-rapid-cdn-log-aggregator:target}
