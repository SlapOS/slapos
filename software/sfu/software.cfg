[buildout]
extends =
  ../../component/golang/buildout.cfg
  ../../component/openssl/buildout.cfg
  ../../stack/slapos.cfg
#   ./buildout.hash.cfg

parts =
  slapos-cookbook
  sfu
  eggs
  instance

# eggs for instance.cfg
[eggs]
recipe  = zc.recipe.egg
eggs    =
    plone.recipe.command
    collective.recipe.template


[sfu-repository]
<= git-repository
repository = https://lab.nexedi.com/alain.takoudjou/sfu.git
branch = sfu-conference
location = ${buildout:parts-directory}/sfu-repository

[sfu]
recipe = slapos.recipe.cmmi
path = ${sfu-repository:location}
location = @@LOCATION@@
golang  = ${golang1.13:location}
configure-command = true
make-binary = 
make-targets =
  go install -ldflags='-s -w'
environment =
  PATH=${:location}/bin:${:golang}/bin:${git:location}/bin:${pkgconfig:location}/bin:$PATH
  GOPATH=${:location}
  CGO_ENABLED=0

[instance]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/${:filename}
mode = 0644
output = ${buildout:directory}/instance.cfg
filename = instance.cfg.in
md5sum = a9837c7a63a113766799756f47cf04fd

[versions]
slapos.recipe.template = 4.4
