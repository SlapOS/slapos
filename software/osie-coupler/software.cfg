[buildout]
parts =
  slapos-cookbook
  instance-profile
  linuxptp

extends =
  ../../stack/monitor/buildout.cfg
  ../../stack/slapos.cfg
  ../../component/linuxptp/buildout.cfg
  ../../component/osie-coupler/buildout.cfg
  buildout.hash.cfg

[osie-coupler]
bin_dir = ${buildout:directory}/bin/
post-install =
  cp bin/server ${:bin_dir}

[instance-profile]
recipe = slapos.recipe.template:jinja2
url = ${:_profile_base_location_}/${:filename}
mode = 0644
output = ${buildout:directory}/instance.cfg
extensions = jinja2.ext.do
context =
  section buildout buildout
  raw template_monitor ${monitor2-template:output}
  key coupler_location osie-coupler:bin_dir
