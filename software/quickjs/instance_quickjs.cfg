[buildout]
parts =
    launcher
    publish-connection-information

eggs-directory = ${buildout:eggs-directory}
develop-eggs-directory = ${buildout:develop-eggs-directory}
offline = true

[rootdirectory]
recipe = slapos.cookbook:mkdirectory
etc = $${buildout:directory}/etc
var = $${buildout:directory}/var
srv = $${buildout:directory}/srv
tmp = $${buildout:directory}/tmp

[basedirectory]
recipe = slapos.cookbook:mkdirectory
services = $${rootdirectory:etc}/run
log = $${rootdirectory:var}/log
run = $${rootdirectory:var}/run
data = $${rootdirectory:srv}/quickjs

[quickjs-workspace]
# Log
path_log = $${basedirectory:log}/quickjs.log

# Docroot
docroot = $${basedirectory:data}

# Executables
bin_quickjs = ${quickjs:location}/bin/qjs
bin_launcher = $${basedirectory:services}/launcher

# Utils
path_shell = ${dash:location}/bin/dash

[launcher]
recipe = slapos.recipe.template:jinja2
template = ${template_launcher:location}/${template_launcher:filename}
rendered = $${quickjs-workspace:bin_launcher}
mode = 700
context = 
    section param_quickjs quickjs-workspace

[publish-connection-information]
recipe = slapos.cookbook:publish
result = hello
