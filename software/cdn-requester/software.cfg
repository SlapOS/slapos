[buildout]
extends =
  buildout.hash.cfg
  ../../component/openssl/buildout.cfg
  ../../component/coreutils/buildout.cfg
  ../../stack/monitor/buildout.cfg
  ../rapid-cdn/software.cfg
  ../../stack/slapos.cfg

parts +=
  caucase-eggs
  template
  software-install
  kedifa
  slapos-cookbook-develop
  instance.cfg.in

#allow-picked-versions = true

[slapos.cookbook-repository]
location = /home/cedric/code/slapos/
develop = true

[slapos-cookbook-develop]
foo = hikkjkjssssjjjj
[slapos-cookbook]
foo = thkdsssjjkkkkkjjj


[instance.cfg.in]
<= copy-to-instance
recipe = slapos.recipe.template:jinja2
output = ${buildout:directory}/template.cfg
context =
  section software_parameter_dict software-parameter-section

[template]
output = ${buildout:directory}/template.root.cfg

[software-parameter-section]
# profiles
instance-requester-input-schema.json = ${instance-requester-input-schema.json:target}
instance-requester-output-schema.json = ${instance-requester-output-schema.json:target}
instance-slave-input-schema.json = ${instance-slave-input-schema.json:target}
instance-slave-output-schema.json = ${instance-slave-output-schema.json:target}
instance-kedifa-input-schema.json = ${instance-kedifa-input-schema.json:target}
instance-kedifa-output-schema.json = ${instance-kedifa-output-schema.json:target}
instance-input-schema.json = ${instance-input-schema.json:target}
instance-output-schema.json = ${instance-output-schema.json:target}
software.cfg.json = ${software.cfg.json:target}
instance-instancenode.cfg.in = ${instance-instancenode.cfg.in:destination}
instancenode.cfg.in = ${instancenode.cfg.in:output}
template_monitor = ${monitor2-template:output}
cdnrequest-bin = ${buildout:directory}/bin/cdnrequest-script
rapid-cdn-root-template = ${template:output}
rapid-cdn-master-template = ${profile-master:target}

[copy-to-instance]
recipe   = slapos.recipe.build:download
url      = ${:_profile_base_location_}/${:_buildout_section_name_}
filename = ${:_buildout_section_name_}
_update_hash_filename_ = ${:_buildout_section_name_}

[copy-at-root]
<= copy-to-instance
destination = ${buildout:directory}/${:_buildout_section_name_}

[instance-instancenode.cfg.in]
<= copy-at-root
output = ${buildout:directory}/${:_buildout_section_name_}

[instancenode.cfg.in]
<= copy-at-root
recipe = slapos.recipe.template
output = ${buildout:directory}/{:_buildout_section_name_}

[instance.cfg.in]
<= copy-at-root

[instance-common.cfg.in]
<= copy-at-root

[instance-requester-input-schema.json]
<= copy-at-root

[instance-requester-output-schema.json]
<= copy-at-root

[instance-slave-input-schema.json]
<= copy-at-root

[instance-slave-output-schema.json]
<= copy-at-root

[software.cfg.json]
<= copy-at-root

[versions]
furl = 2.1.4
validators = 0.35.0
orderedmultidict = 1.0.1
slapos.core = 1.19.0
slapos.toolbox = 0.161