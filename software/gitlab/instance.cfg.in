# GitLab "switch-softwaretype" instance
[buildout]
parts = switch-softwaretype

# std stuff for slapos instance
eggs-directory = ${buildout:eggs-directory}
develop-eggs-directory = ${buildout:develop-eggs-directory}
offline = true


[switch-softwaretype]
recipe = slapos.cookbook:softwaretype
default = $${instance-gitlab.cfg:rendered}
# TODO -export, -import, -pull-backup


[instance-gitlab.cfg]
recipe  = slapos.recipe.template:jinja2
mode    = 0644
template= ${instance-gitlab.cfg.in:target}
rendered= $${buildout:directory}/instance-gitlab.cfg
context =
    key eggs_directory          buildout:eggs-directory
    key develop_eggs_directory  buildout:develop-eggs-directory
    raw gitlab_repository_location          ${gitlab-repository:location}
    raw gitlab_shell_repository_location    ${gitlab-shell-repository:location}

# program binaries
    raw bundler_4gitlab             ${bundler-4gitlab:bundle}
    raw dcron_bin                   ${dcron-output:crond}
    raw git                         ${git:location}/bin/git
    raw gunzip_bin                  ${gzip:location}/bin/gunzip
    raw gzip_bin                    ${gzip:location}/bin/gzip
    raw logrotate_bin               ${logrotate:location}/usr/sbin/logrotate
    raw postgresql_location         ${postgresql92:location}
    raw redis_binprefix             ${redis28:location}/bin
