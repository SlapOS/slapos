[buildout]
extends = common.cfg

[versions]
PyRSS2Gen = 1.1
cns.recipe.symlink = 0.2.3
ecdsa = 0.13
gitdb = 0.6.4
plone.recipe.command = 1.1
pycrypto = 2.6.1
rdiff-backup = 1.0.5+SlapOSPatched001
slapos.recipe.template = 4.3
smmap = 0.9.0
numpy = 1.16.4

websockify = 0.8.0


### backported fixes

# version up important components that do not compile with gcc 10
[gdbm]
version = 1.22
md5sum = 0bbd38f12656e4728e2f7c4708aec014
[logrotate]
url = https://github.com/logrotate/logrotate/releases/download/3.18.1/logrotate-3.18.1.tar.xz
md5sum = 07d5aba26c350f9ab5730c25a7277751


# disable not used components for simplicity
[nginx-push-stream]
# nginx-push-stream does not compile with gcc 10
recipe =
location =
[nginx-push-stream-output]
recipe =
location =
[npm-modules]
# npm-modules pulls nodejs and gcc 5.5
# gcc 5.5 does not compile with gcc 10
command = :


# fixes for python packages using setup_requires
[slapos-cookbook]
depends = ${slapos-cookbook-dependencies:eggs}

[slapos-cookbook-dependencies]
recipe = zc.recipe.egg
eggs =
  ${lxml-python:egg}
  ${python-cffi:egg}
  ${python-PyYAML:egg}
  ${python-cachecontrol:egg}
  ${python-cliff:egg}
  ${python-cryptography:egg}
  ${jsonschema:egg}
  ${python-dateutil:egg}

[jsonschema]
recipe = zc.recipe.egg:custom
egg = ${:_buildout_section_name_}
setup-eggs = setuptools_scm

[python-dateutil]
recipe = zc.recipe.egg:custom
egg = ${:_buildout_section_name_}
setup-eggs = setuptools_scm

[versions]
setuptools-scm = 3.5.0


# pyrsistent 0.14.5 has a setup_requires, which is installed regardless of
# buildout versions and pickup a version incompatible with python 2,
# preventing installation.
# pyrsistent 0.16.1 does not have this setup_requires, which makes the
# software installable again.
[versions]
pyrsistent = 0.16.1
