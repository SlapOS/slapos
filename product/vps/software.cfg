[buildout]
extends =
  ../kvm/software.cfg
  buildout.hash.cfg

parts += instance.json

[download-vps-base]
# we cannot use "download-base" section because:
# 1. we need _profile_base_location to point to current directory for our own files
# 2. we need json to be in specific directory
recipe = slapos.recipe.build:download
url = ${:_profile_base_location_}/${:filename}

[directory]
recipe = slapos.cookbook:mkdirectory
json-vps = ${buildout:parts-directory}/json-schema/product/vps
json-kvm = ${buildout:parts-directory}/json-schema/software/kvm

[software.json]
<= download-vps-base
destination = ${directory:json-vps}/${:filename}

[instance.json]
<= download-vps-base
destination = ${directory:json-kvm}/${:filename}

[template]
<= template-base
# we need to overwrite _profile_base_location to current directory
url = ${:_profile_base_location_}/${:filename}
